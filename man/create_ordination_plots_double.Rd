% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/beta_updates.R
\name{create_ordination_plots_double}
\alias{create_ordination_plots_double}
\title{Create Ordination Plots with Statistical Comparisons (Dual Group Version)}
\usage{
create_ordination_plots_double(
  ps_obj,
  method = "PCoA",
  distance_method = "bray",
  group = "bmi_group",
  size = 10,
  palette,
  taxa_plot = FALSE,
  taxrank = "Genus",
  top_taxa = 10,
  len_axis = 1,
  ratio = c(1, 3),
  additional_group = NULL,
  shape_palette = NULL,
  additional_palette = NULL
)
}
\arguments{
\item{ps_obj}{A phyloseq object containing microbiome data}

\item{method}{Ordination method ("PCoA", "NMDS", etc.) (default: "PCoA")}

\item{distance_method}{Distance metric ("wunifrac", "bray", etc.) (default: "bray")}

\item{group}{Character string specifying the primary metadata column to group by}

\item{size}{Base font size for plot elements (default: 10)}

\item{palette}{Vector of colors for primary groups}

\item{taxa_plot}{Logical indicating whether to plot taxa vectors (default: FALSE)}

\item{taxrank}{Taxonomic level for taxa vector analysis ("Phylum", "Genus", etc.)
(default: "Genus")}

\item{top_taxa}{Number of top significant taxa vectors to display
(default: 10)}

\item{len_axis}{Scaling factor for taxa vectors (default: 1)}

\item{ratio}{Parameter indicating the ratio of figures (default: c(1, 3))}

\item{additional_group}{Secondary grouping variable (default: 'NONE')}

\item{shape_palette}{Vector of shapes for secondary grouping variable}

\item{additional_palette}{Vector of colors for secondary groups}
}
\value{
A grid.arrange object containing the ordination plot with marginal distributions
}
\description{
This function generates ordination plots (e.g., PCoA) from a phyloseq object
with statistical comparisons between groups. It creates a main ordination plot with
ellipses, group means, and ANOSIM results, along with marginal distribution plots
showing group differences along each axis. Supports dual grouping variables.
}
\details{
The function performs the following analysis:
\enumerate{
\item Calculates distance matrix and performs ordination
\item Computes ANOSIM to test group differences
\item Plots ordination with ellipses and group means
\item Adds significant taxa vectors (if taxa_plot = TRUE)
\item Creates marginal violin plots with statistical comparisons
}

When two grouping variables are provided:
\itemize{
\item Primary variable represented by color
\item Secondary variable represented by shape
\item Separate violins shown for each variable
}
}
\examples{
\dontrun{
# Example with two grouping variables:
p <- create_ordination_plots_double(
  ps_obj = my_phyloseq,
  group = "BMI",
  additional_group = "Treatment",
  palette = c("Normal" = "green", "Obese" = "red"),
  additional_palette = c("Control" = "gray", "Treated" = "blue"),
  shape_palette = c(16, 17)
)
}

}
