% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/beta.R
\name{create_ordination_plots}
\alias{create_ordination_plots}
\title{Create Ordination Plots with Statistical Comparisons}
\usage{
create_ordination_plots(
  ps_obj,
  method = "PCoA",
  distance_method = "bray",
  group,
  size = 10,
  palette,
  taxa_plot = TRUE,
  taxrank = "Genus",
  top_taxa = 10,
  len_axis = 1,
  ratio = c(1, 4),
  font_family = "Times New Roman"
)
}
\arguments{
\item{ps_obj}{A phyloseq object containing microbiome data}

\item{method}{Ordination method ("PCoA", "NMDS", etc.) (default: "PCoA")}

\item{distance_method}{Distance metric ("wunifrac", "bray", etc.) (default: "bray")}

\item{group}{Character string specifying the metadata column to group by}

\item{size}{Base font size for plot elements (default: 10)}

\item{palette}{Vector of colors for groups}

\item{taxa_plot}{Logical indicating whether to plot taxa vectors (default: TRUE)}

\item{taxrank}{Taxonomic level for taxa vector analysis ("Phylum", "Genus", etc.)
(default: "Genus")}

\item{top_taxa}{Number of top significant taxa vectors to display
(default: 10, set to NULL to show all significant taxa)}

\item{len_axis}{Scaling factor for taxa vectors (default: 1)}

\item{ratio}{Parameter indicating the ratio of figures}

\item{font_family}{Font family to use (default: "Times New Roman")}
}
\value{
A grid.arrange object containing the ordination plot with marginal distributions
}
\description{
This function generates ordination plots (e.g., PCoA) from a phyloseq object
with statistical comparisons between groups. It creates a main ordination plot with
ellipses, group means, and ANOSIM results, along with marginal distribution plots
showing group differences along each axis.
}
\details{
The function performs the following analysis:
\enumerate{
\item Calculates distance matrix and performs ordination
\item Computes ANOSIM to test group differences
\item Plots ordination with ellipses and group means
\item Adds significant taxa vectors (if taxa_plot = TRUE)
\item Creates marginal violin plots with statistical comparisons
}

When taxa_plot = TRUE, the function will:
\itemize{
\item Aggregate taxa at the specified taxonomic rank (taxrank)
\item Perform envfit analysis to find significant taxa vectors
\item Display the top_taxa most significant vectors (by r value)
\item Scale vectors by len_axis for better visualization
}
}
\examples{
\dontrun{
# Example usage:
colors <- c("Group1" = "blue", "Group2" = "red")
p <- create_ordination_plots(
  ps_obj = my_phyloseq,
  method = "PCoA",
  distance_method = "bray",
  group = "Treatment",
  palette = colors
)
print(p)
}

}
