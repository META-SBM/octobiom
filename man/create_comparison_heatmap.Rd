% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/diff_analysis.R
\name{create_comparison_heatmap}
\alias{create_comparison_heatmap}
\title{Create Comparative Heatmap with Abundance and Prevalence Annotations}
\usage{
create_comparison_heatmap(
  data_deseq,
  data_maaslin,
  ref_group,
  comp_group,
  taxa_level,
  ps_obj,
  group_var_abund_prev,
  comparison_name,
  group_colors_abund_prev = NULL,
  color_low = "#45CAFF",
  color_mid = "white",
  color_high = "#DE3163",
  text_size = 9,
  pvalue_digits = 2,
  heatmap_height = 10,
  heatmap_width = 7,
  number_model_true = 2
)
}
\arguments{
\item{data_deseq}{Dataframe containing DESeq2 results (must include Taxon, coef,
model, padj, signif columns).}

\item{data_maaslin}{Dataframe containing Maaslin2 results (same structure as data_deseq).}

\item{ref_group}{Character string specifying the reference group.}

\item{comp_group}{Character string specifying the comparison group.}

\item{taxa_level}{Character string specifying the taxonomic level to analyze (e.g., "Species").}

\item{ps_obj}{Phyloseq object containing microbial abundance data.}

\item{group_var_abund_prev}{Character string specifying grouping variable for abundance/prevalence plots.}

\item{comparison_name}{Character string for plot title.}

\item{group_colors_abund_prev}{Named vector of colors for groups (optional).}

\item{color_low}{Hex color for negative coefficients (default: "#45CAFF").}

\item{color_mid}{Hex color for zero coefficients (default: "white").}

\item{color_high}{Hex color for positive coefficients (default: "#DE3163").}

\item{text_size}{Base text size for plots (default: 9).}

\item{pvalue_digits}{Number of digits for p-value formatting (default: 2).}

\item{heatmap_height}{Height of heatmap in cm (default: 10).}

\item{heatmap_width}{Width of heatmap in cm (default: 7).}

\item{number_model_true}{Threshold for minimum non-zero models required per taxon (default: 2).}
}
\value{
A list containing:
\itemize{
\item heatmap_plot - Combined plot as ggplot object
\item heatmap_obj - Raw ComplexHeatmap object for further customization
}
}
\description{
Generates a complex heatmap comparing coefficients from different models with
abundance and prevalence annotations. The function handles data from DESeq2 and
Maaslin2, ensures consistent effect directions, and provides customizable
visualizations.
}
\examples{
\dontrun{
result <- create_comparison_heatmap(
  data_deseq = deseq_results,
  data_maaslin = maaslin_results,
  ref_group = "Control",
  comp_group = "Treatment",
  taxa_level = "Species",
  ps_obj = phyloseq_data,
  group_var_abund_prev = "Group",
  comparison_name = "Control vs Treatment"
)
print(result[[1]])  # Display the plot
}

}
