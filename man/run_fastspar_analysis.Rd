% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/network_correlation_bacteria.R
\name{run_fastspar_analysis}
\alias{run_fastspar_analysis}
\title{Run FastSpar Network Analysis Pipeline}
\usage{
run_fastspar_analysis(
  conda_env = "fastspar",
  input_dir = ".",
  output_dir = "results",
  otu_table = "otu_table.tsv",
  iterations = 50,
  exclusion_iterations = 10,
  threshold = 0.1,
  threads = 1,
  seed = 1,
  permutations = 1000,
  cor_threshold = 0.3,
  p_adjust_method = "BH",
  remove_temp = TRUE,
  ps_obj = ps_obj
)
}
\arguments{
\item{conda_env}{Character. Name of the conda environment containing FastSpar (default: "fastspar").}

\item{input_dir}{Character. Path to directory containing input OTU table (default: ".").}

\item{output_dir}{Character. Path to directory for output files (default: "results").}

\item{otu_table}{Character. Filename of OTU table (default: "otu_table.tsv").}

\item{iterations}{Integer. Number of iterations for FastSpar (default: 50).}

\item{exclusion_iterations}{Integer. Number of exclusion iterations (default: 10).}

\item{threshold}{Numeric. Correlation strength exclusion threshold (default: 0.1).}

\item{threads}{Integer. Number of threads for parallel processing (default: 1).}

\item{seed}{Integer. Random number generator seed (default: 1).}

\item{permutations}{Integer. Number of bootstrap permutations (default: 1000).}

\item{cor_threshold}{Numeric. Minimum absolute correlation for edge inclusion (default: 0.3).}

\item{p_adjust_method}{Character. Method for p-value adjustment (default: "BH").}

\item{remove_temp}{Logical. Remove temporary bootstrap files? (default: TRUE).}

\item{ps_obj}{phyloseq object. Optional phyloseq object for CLR abundance calculation.}
}
\value{
A list containing:
\itemize{
\item graph - igraph network object
\item adjacency_matrix - Filtered adjacency matrix
\item correlation_matrix - Raw correlation matrix
\item pvalues - Adjusted p-value matrix
\item plot - ggraph visualization of the network
}
}
\description{
This function performs a complete microbial co-occurrence network analysis using FastSpar,
including correlation calculation, bootstrap analysis, p-value estimation, and network visualization.
}
\details{
The function performs the following steps:
\enumerate{
\item Calculates correlations using FastSpar
\item Performs bootstrap analysis
\item Estimates p-values
\item Filters correlations based on significance and threshold
\item Constructs and visualizes the network
\item Calculates network metrics (modularity, connectivity, etc.)
}
}
\examples{
\dontrun{
result <- run_fastspar_analysis(
  conda_env = "fastspar",
  input_dir = "path/to/data",
  ps_obj = phyloseq_object
)
print(result$plot)
}

}
